import ast
import datetime
import logging
import operator
import sys
import os
import uuid
from airflow import DAG
from airflow import models
from airflow.api.common.experimental.get_task_instance import get_task_instance
from airflow.providers.google.cloud.operators.bigquery import BigQueryInsertJobOperator
from airflow.providers.google.cloud.operators.bigquery import BigQueryValueCheckOperator
from airflow.providers.google.cloud.operators.dataproc import DataprocSubmitJobOperator
from airflow.models import DagRun
from airflow.operators.trigger_dagrun import TriggerDagRunOperator
from airflow.operators.python import PythonOperator
from airflow.operators.dummy import DummyOperator
from common_modules import getconfig
from common_modules import jobexecmodule
from common_modules import vertexaiexemodule
from airflow.providers.google.cloud.operators.mlengine import MLEngineStartTrainingJobOperator
from airflow.providers.google.cloud.operators.vertex_ai.model_service import ExportModelOperator
from airflow.providers.google.cloud.operators.vertex_ai.model_service import DeleteModelOperator
from airflow.providers.google.cloud.operators.vertex_ai.model_service import UploadModelOperator
from airflow.providers.google.cloud.operators.vertex_ai.custom_job import CreateCustomPythonPackageTrainingJobOperator
from airflow.providers.google.cloud.operators.vertex_ai.custom_job import CreateCustomContainerTrainingJobOperator